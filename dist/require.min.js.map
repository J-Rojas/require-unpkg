{"version":3,"file":"require.min.js","sources":["../src/cache.js","../src/require.js"],"sourcesContent":["let localStorage\nif (typeof window === 'undefined') {\n\t//For node environment\n\tconst obj = {}\n\tlocalStorage = {\n\t\tsetItem(k, v) {\n\t\t\tobj[k] = v\n\t\t},\n\t\tgetItem(k) {\n\t\t\treturn obj[k] || null\n\t\t},\n\t\tremoveItem(k) {\n\t\t\tdelete obj[k]\n\t\t}\n\t}\n} else {\n\tlocalStorage = window.localStorage\n}\nconst ns = 'require-unpkg-cache'\nconst cache = {\n\tobj: {},\n\tset(k, v) {\n\t\tthis.obj[k] = { content: v, timestamp: Date.now() }\n\t\tlocalStorage.setItem(ns, JSON.stringify(this.obj))\n\t},\n\tget(k) {\n\t\tif (!this.has(k)) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.obj[k].content\n\t},\n\thas(k) {\n\t\tif (!(k in this.obj)) {\n\t\t\treturn false\n\t\t}\n\t\tlet g = this.obj[k]\n\t\tif (Date.now() - g.timestamp < this.expire) {\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t},\n\texpire: 24 * 60 * 60 * 1000 //24hours\n}\nif (localStorage.getItem(ns)) {\n\ttry {\n\t\tcache.obj = JSON.parse(localStorage.getItem(ns))\n\t} catch (e) {\n\t\tlocalStorage.removeItem(ns)\n\t}\n}\n\nexport default cache\n","import cache from './cache'\n\n//internal get\nfunction _get(url) {\n\treturn new Promise((res, rej) => {\n\t\tlet xhr = new require.XMLHttpRequest()\n\n\t\txhr.open('GET', url)\n\n\t\txhr.onload = () => res(xhr.responseText)\n\t\txhr.onerror = () => rej(xhr.statusText)\n\n\t\txhr.setRequestHeader('Cache-Control', 'no-cache')\n\n\t\txhr.send()\n\t})\n}\n\n//internal require\nasync function _require(pkg, options) {\n\tpkg = pkg.toLowerCase()\n\tif (!cache.has(pkg)) {\n\t\tlet js = await _get(`https://unpkg.com/${pkg}}` + (options.cacheBust ? '?time=' + Date.now() : ''))\n\t\tcache.set(pkg, js)\n\t}\n\tlet module = { exports: {} }\n\tlet codeStr = cache.get(pkg)\n\tlet code = new Function(['module', 'exports'], codeStr)\n\tcode.apply(null, [module, module.exports])\n\treturn module.exports\n}\n\n/**\n * require module from unpkg.com\n * @function require\n * @param {String|String[]} package module name or modules name\n * @param {Object} options loading options\n * @return {Promise<Object>|Promise<Object[]>} return promise with module or array of module\n */\nasync function require(pkg, options) {\n\tif (!Array.isArray(pkg)) return await _require(pkg, Object.assign({cacheBust: false}, options || {}))\n\telse {\n\t\tlet pms = pkg.map(p => _require(p))\n\t\treturn await Promise.all(pms)\n\t}\n}\n\nif (typeof window !== 'undefined') {\n\trequire.XMLHttpRequest = window.XMLHttpRequest\n}\n\nrequire.cache = cache\nrequire._require = _require\nrequire._get = _get\n\nexport default require\n"],"names":["localStorage","window","obj","setItem","k","v","getItem","removeItem","ns","cache","set","content","timestamp","Date","now","JSON","stringify","this","get","has","g","expire","parse","e","_get","url","Promise","res","rej","xhr","require","XMLHttpRequest","open","onload","responseText","onerror","statusText","setRequestHeader","send","async","_require","pkg","options","toLowerCase","js","cacheBust","module","exports","codeStr","Function","apply","Array","isArray","pms","map","p","all","Object","assign"],"mappings":"mLAAA,IAAIA,EACJ,GAAsB,oBAAXC,OAAwB,OAE5BC,EAAM,GACZF,EAAe,CACdG,QAAQC,EAAGC,GACVH,EAAIE,GAAKC,GAEVC,QAAQF,GACAF,EAAIE,IAAM,KAElBG,WAAWH,UACHF,EAAIE,UAIbJ,EAAeC,OAAOD,aAEvB,MAAMQ,EAAK,sBACLC,EAAQ,CACbP,IAAK,GACLQ,IAAIN,EAAGC,QACDH,IAAIE,GAAK,CAAEO,QAASN,EAAGO,UAAWC,KAAKC,OAC5Cd,EAAaG,QAAQK,EAAIO,KAAKC,UAAUC,KAAKf,OAE9CgB,IAAId,UACEa,KAAKE,IAAIf,GAGPa,KAAKf,IAAIE,GAAGO,QAFX,MAITQ,IAAIf,QACGA,KAAKa,KAAKf,YACR,MAEJkB,EAAIH,KAAKf,IAAIE,UACbS,KAAKC,MAAQM,EAAER,UAAYK,KAAKI,QAKrCA,OAAQ,OAET,GAAIrB,EAAaM,QAAQE,OAEvBC,EAAMP,IAAMa,KAAKO,MAAMtB,EAAaM,QAAQE,IAC3C,MAAOe,GACRvB,EAAaO,WAAWC,GC5C1B,SAASgB,EAAKC,UACN,IAAIC,QAAQ,CAACC,EAAKC,SACpBC,EAAM,IAAIC,EAAQC,eAEtBF,EAAIG,KAAK,MAAOP,GAEhBI,EAAII,OAAS,KAAMN,EAAIE,EAAIK,eAC3BL,EAAIM,QAAU,KAAMP,EAAIC,EAAIO,aAE5BP,EAAIQ,iBAAiB,gBAAiB,YAEtCR,EAAIS,SAKNC,eAAeC,EAASC,EAAKC,MAC5BD,EAAMA,EAAIE,eACLlC,EAAMU,IAAIsB,GAAM,KAChBG,QAAWpB,uBAA0BiB,MAAUC,EAAQG,UAAY,SAAWhC,KAAKC,MAAQ,KAC/FL,EAAMC,IAAI+B,EAAKG,OAEZE,EAAS,CAAEC,QAAS,IACpBC,EAAUvC,EAAMS,IAAIuB,UACb,IAAIQ,SAAS,CAAC,SAAU,WAAYD,GAC1CE,MAAM,KAAM,CAACJ,EAAQA,EAAOC,UAC1BD,EAAOC,QAUfR,eAAeT,EAAQW,EAAKC,MACtBS,MAAMC,QAAQX,GACd,KACAY,EAAMZ,EAAIa,IAAIC,GAAKf,EAASe,iBACnB7B,QAAQ8B,IAAIH,GAHD,aAAab,EAASC,EAAKgB,OAAOC,OAAO,CAACb,WAAW,GAAQH,GAAW,WAO5E,oBAAXzC,SACV6B,EAAQC,eAAiB9B,OAAO8B,gBAGjCD,EAAQrB,MAAQA,EAChBqB,EAAQU,SAAWA,EACnBV,EAAQN,KAAOA"}