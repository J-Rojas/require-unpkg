{"version":3,"file":"require-unpkg.min.js","sources":["../src/cache.js","../src/require.js","../src/index.js"],"sourcesContent":["//module cache\nconst ns = 'require-unpkg-cache'\nconst cache = {\n\tobj: {},\n\tset(k, v) {\n\t\tthis.obj[k] = { content: v, timestamp: Date.now() }\n\t\tlocalStorage.setItem(ns, JSON.stringify(this.obj))\n\t},\n\tget(k) {\n\t\tif (!this.has(k)) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.obj[k].content\n\t},\n\thas(k) {\n\t\tif (!(k in this.obj)) {\n\t\t\treturn false\n\t\t}\n\t\tlet g = this.obj[k]\n\t\tif (Date.now() - g.timestamp < this.expire) {\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t},\n\texpire: 24 * 60 * 60 * 1000 //24hours\n}\nif (localStorage.getItem(ns)) {\n\ttry {\n\t\tcache.obj = JSON.parse(localStorage.getItem(ns))\n\t} catch (e) {\n\t\tlocalStorage.removeItem(ns)\n\t}\n}\n\nexport default cache\n","import cache from './cache'\n\n//internal get\nfunction _get(url) {\n\treturn new Promise((res, rej) => {\n\t\tlet xhr = new require.XMLHttpRequest()\n\n\t\txhr.open('GET', url)\n\n\t\txhr.onload = () => res(xhr.responseText)\n\t\txhr.onerror = () => rej(xhr.statusText)\n\n\t\txhr.setRequestHeader('Cache-Control', 'no-cache')\n\n\t\txhr.send()\n\t})\n}\n\n//internal require\nasync function _require(pkg) {\n\tpkg = pkg.toLowerCase()\n\tif (!cache.has(pkg)) {\n\t\tlet js = await _get(`https://unpkg.com/${pkg}?time=${Date.now()}`)\n\t\tcache.set(pkg, js)\n\t}\n\tlet module = { exports: {} }\n\tlet code = new Function(['module', 'exports'], cache.get(pkg))\n\tcode.apply(null, [module, module.exports])\n\treturn module.exports\n}\n\n/**\n * require module from unpkg.com\n * @function require\n * @param {String|String[]} package module name or modules name\n * @return {Promise<Object>|Promise<Object[]>} return promise with module or array of module\n */\nasync function require(pkg) {\n\tif (!Array.isArray(pkg)) return await _require(pkg)\n\telse {\n\t\tlet pms = pkg.map(p => _require(p))\n\t\treturn await Promise.all(pms)\n\t}\n}\n\nif (typeof window !== 'undefined') {\n\trequire.XMLHttpRequest = window.XMLHttpRequest\n}\n\nrequire.cache = cache\nrequire._require = _require\nrequire._get = _get\n\nexport default require\n","//entry point\nmodule.exports = require('./require').default\n"],"names":["const","ns","cache","k","v","obj","content","timestamp","Date","now","setItem","JSON","stringify","this","has","g","expire","localStorage","getItem","parse","e","removeItem","_get","url","Promise","res","rej","xhr","require","XMLHttpRequest","open","onload","responseText","onerror","statusText","setRequestHeader","send","_require","pkg","module","js","toLowerCase","$await_3","set","exports","Function","get","apply","pms","Array","isArray","map","p","all","window","default"],"mappings":"mLACAA,IAAMC,EAAK,sBACLC,uBAEDC,EAAGC,QACDC,IAAIF,IAAOG,QAASF,EAAGG,UAAWC,KAAKC,oBAC/BC,QAAQT,EAAIU,KAAKC,UAAUC,KAAKR,oBAE1CF,UACEU,KAAKC,IAAIX,GAGPU,KAAKR,IAAIF,GAAGG,QAFX,mBAILH,QACGA,KAAKU,KAAKR,YACR,MAEJU,EAAIF,KAAKR,IAAIF,UACbK,KAAKC,MAAQM,EAAER,UAAYM,KAAKG,eAK7B,OAET,GAAIC,aAAaC,QAAQjB,SAEjBI,IAAMM,KAAKQ,MAAMF,aAAaC,QAAQjB,IAC3C,MAAOmB,gBACKC,WAAWpB,GC3B1B,SAASqB,EAAKC,UACN,IAAIC,iBAASC,EAAKC,OACpBC,EAAM,IAAIC,EAAQC,iBAElBC,KAAK,MAAOP,KAEZQ,yBAAeN,EAAIE,EAAIK,iBACvBC,0BAAgBP,EAAIC,EAAIO,eAExBC,iBAAiB,gBAAiB,cAElCC,SAKN,SAAeC,EAASC,wCAMnBC,EAHCC,OAFCF,EAAIG,eACLvC,EAAMY,IAAIwB,0BACChB,uBAA0BgB,WAAY9B,KAAKC,sCAAjDiC,IACHC,IAAIL,EAAKE,4EAEDI,YACJ,IAAIC,UAAU,SAAU,WAAY3C,EAAM4C,IAAIR,IACpDS,MAAM,MAAOR,EAAQA,EAAOK,YAC1BL,EAAOK,0CASf,SAAehB,EAAQU,wCAGjBU,SAFAC,MAAMC,QAAQZ,MAERA,EAAIa,aAAIC,UAAKf,EAASe,qBACnB5B,QAAQ6B,IAAIL,+BAHYX,EAASC,2BAO1B,oBAAXgB,WACFzB,eAAiByB,OAAOzB,gBAGjCD,EAAQ1B,MAAQA,EAChB0B,EAAQS,SAAWA,EACnBT,EAAQN,KAAOA,mDClDuBiC"}